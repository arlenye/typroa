## AOP底层实现原理，动态代理



### AOP：面向切面编程

AOP是一种编程思想，核心思想--解耦

事务     

开启一个事务

执行提交事务

事务回滚

关闭事务

这种有规律的东西，就可以认为是一个固定的规则，这时候，我们可以把这个具有一定规律的规则，单独分离出来，作为一个独立的模块。这个模块就是个切面



Authentication权限认证

Logging 日志

Transaction 事务

Lazy Loading 懒加载

Context Process 上下文处理

Error Handler 错误跟踪（异常捕获机制）

Cache缓存处理



### 动态代理

只是AOP的一种技术实现手段

代理模式应用场景3个必要条件

1. 2个角色，执行者和被代理对象
2. 注重过程，必须要做，但被代理对象自己没时间做，或不想做，不专业
3. 执行者必须持有被代理对象的引用

JDK动态代理：

1. 代理类  实现Invocationhandler的invoke方法  ，持有代理类的引用
2. 被代理类 接口 +实现类

Cglib动态代理：

1. 代理类实现MehtodInterceptor接口的intercept方法
2. 被代理类  class
3. Cglib会生成被代理类的一个子类，字节码重组



### AspectJ切面

|      |
| ---- |
|      |
|      |
|      |

由某几个本来不相干的东西组合到一块形成一个行的产品

螺丝和螺帽配套，螺丝工厂A生产，螺帽工厂B生产，螺丝和螺帽必须遵循一定的标准生产才能够配套，拧到一起。

标准、规则：外径一致，螺纹走向一致



与其说面向切面编程，不如说面向规则编程

事务代理：加在service层增、删、改等方法上



先要把一个整体给拆了，分别开发

等到发布的时候，再组装到一起运行

### 目的

解耦，专人干专事

### OOP：封装继承多态

现象（关注技术细节，面向过程）

OOP用代码去描述这个世界

关心的是事物之间的联系



### BOP：面向Bean编程

Bean与bean之间的关系，不希望每次都去认为重复new

由程序来事现自动管理，spring开始就是从bean的管理开始的

### IOC： 控制反转

创建对象的控制权反转

Spring中，所有的Bean由Spring来创建，Spring容器取得对象创建的控制权

并且创建的对象由Spring管理，出现IOC容器（Map）

### DI：依赖注入

对象依赖的资源动态赋值，动态调用getter，setter（反射技术）

Spring加载步骤：定位、载入、注册，再确定要不要初始化Spring

可以认为启动之前已经注入好了，存在反射带来的性能问题。