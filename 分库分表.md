## 分库分表

### 对于存储层的压力知道如何去提供解决方案和思路

为什么哟啊分库分表

超大容量问题

性能问题

### 对分库分表的常用手段有全面了解

如何做到封库分表

垂直切分 水平切分

1.   垂直分库； 解决的是表过多的问题

2.   垂直分表； 解决单表列过多的问题

 

水平切分； 大数据表拆成小表

## 常见的拆分策略

垂直拆分（er分片）

 er关系分片即可以理解为有关联关系表之间数据分片。类似于订单主表与订单详情表间的分片存储规则。 

水平拆分

一致性hash

范围切分 可以按照ID

日期拆分



## 拆分以后带来的问题

### 跨库join的问题

1.   设计的时候考虑到应用层的join问题。

2.   在服务层去做调用；

A服务里查询到一个list

for(list){

   bservice.select(list);

}

3.   全局表

1.   数据变更比较少的基于全局应用的表

2.    

4.   做字段冗余（空间换时间的做法）

订单表。 商家id  商家名称

商家名称变更- 定时任务、任务通知

### 跨分片数据排序分页

### 唯一主键问题

用自增id做主键

UUID 性能比较低

snowflake 

mongoDB 

zookeeper 

数据库表

### 分布式事务问题

多个数据库表之间保证原子性  性能问题； 互联网公司用强一致性分布式事务比较少

 

分库分表最难的在于业务的复杂度； 

前提： 水平分表的前提是已经存在大量的业务数据。而这个业务数据已经渗透到了各个应用节点



# 如何权衡当前公司的存储需要优化

1．     提前规划（主键问题解决、 join问题）

2．     当前数据单表超过1000W、每天的增长量持续上升